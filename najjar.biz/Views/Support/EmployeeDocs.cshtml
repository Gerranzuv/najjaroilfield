@model IEnumerable<najjar.biz.Models.Support>

@{

    Layout = "~/Views/Shared/_Admin_Layout.cshtml";

    var DocsId = Request.QueryString["Employeeid"];


}
<div class="container">
    <div class="row">
        <div class="col-md-3 col-sm-4 sidebar">
            <br />
            <ul class="nav nav-stacked nav-pills">
                @*<li>
                        @Html.ActionLink("Home", "Index", "Home")
                    </li>*@
                <li id="PersonalInfo">
                    @Html.ActionLink("Personal Information", "PersonalPage", "Employee", new { Employeeid = DocsId }, null)
                </li>
                <li id="SalaryInfo">
                    @Html.ActionLink("Salary Information", "SalaryInfo", "Employee", new { Employeeid = DocsId }, null)
                </li>
                <li id="EmployeeDocs" class="active">
                    @Html.ActionLink("My Documents", "EmployeeDocs", "Support", new { Employeeid = DocsId }, null)
                </li>

                <li id="EmployeeVacation" >
                    @Html.ActionLink("Employee Vacation", "EmployeeVacation", "EmployeesVacation", new { Employeeid = DocsId }, null)
                </li>
                <li id="EmployeeRating">
                    @Html.ActionLink("Employee Rating", "EmployeeRating", "EmployeeRating", new { Employeeid = DocsId }, null)
                </li>
                <li id="EmployeeRating" style="color: #071689 !important;">
                    @Html.ActionLink("Termination Info", "TerminationInfo", "Employee", new { Employeeid = DocsId }, null)
                </li>
                @*<li id="Termination">
                    @Html.ActionLink(" Termination Status", "SalaryInfo")
                </li>*@

            </ul>
        </div>

        <div class="col-md-9 col-sm-8" id="PersonalInfoDV">

            <hr />
            <h2  style="color:#071689">Employees Documents</h2>
            <p>
                @Html.ActionLink("Create New", "Create", new { Employeeid = DocsId })

            </p>
            <table class="table">
                <tr>
                    <th>
                        @Html.DisplayNameFor(model => model.Name)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.Summary)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.EmpId)
                    </th>
                    <th> File </th>
                    <th>Total Files</th>
                    <th></th>
                </tr>

                @foreach (var item in Model)
                {
                    <tr>
                        <td>
                            @Html.DisplayFor(modelItem => item.Name)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Summary)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.EmpId)
                        </td>

                        <td>

                            <ul class="attachment">
                                @foreach (var x in item.FileDetails)
                                {
                                    <li>
                                        <a class="title" href="/Support/Download/?p=@(x.Id + x.Extension)&d=@x.FileName">@x.FileName</a>
                                    </li>
                                }
                            </ul>
                        </td>
                        <td>
                            @if (item.FileDetails.Count() == 0)
                            {
                                <span>No File</span>
                            }
                            else
                            {
                                <span>@item.FileDetails.Count() File(s)</span>
                            }
                        </td>

                        <td>
                            @Html.ActionLink("Edit", "Edit", new { id = item.SupportId }) |
                            <a href="javascript:void(0);" data-id="@item.SupportId" class="deleteItem">Delete</a>
                        </td>
                    </tr>
                }

            </table>


        </div>



        <!-- /.row -->
    </div>
    </div>

    @section Scripts {

        <script>
            $('.deleteItem').click(function (e) {
                e.preventDefault();
                var $ctrl = $(this);
                if (confirm('Do you really want to delete this item?')) {
                    $.ajax({
                        url: '@Url.Action("Delete")',
                        type: 'POST',
                        data: { id: $(this).data('id') }
                    }).done(function (data) {
                        if (data.Result == "OK") {
                            $ctrl.closest('tr').remove();
                        }
                        else if (data.Result.Message) {
                            alert(data.Result.Message);
                        }
                    }).fail(function () {
                        alert("There is something wrong. Please try again.");
                    })
                }
            });
        </script>
    }
